<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Httpoxy漏洞预警 · Duolaa</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">Duolaa</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">首页</a></li><li class="nav-link"><a href="/archives/" target="_self">归档</a></li><li class="nav-link"><a href="/tags/" target="_self">标签</a></li><li class="nav-link"><a href="/about/" target="_self">关于</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Httpoxy漏洞预警</h1><span class="post-time">Jul 19, 2016</span><div class="post-content"><p><em>A CGI application vulnerability for PHP, Go, Python and others</em></p>
<h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h2><p>httpoxy漏洞其实就是一个命名冲突的问题，一台使用了httpoxy的服务器，在接受客户端请求之后，服务器会把http变量头转换成大写，并加上HTTP_，如请求头有一个字段是Proxy，之后会变成HTTP_PROXY，其中的value值是不变的。并且在需要的地方转换成了环境变量。这里传进去的变量同名的则被覆盖，</p>
<p><img src="https://github.com/duolaaa/markdownimage/blob/master/071901.png?raw=true" alt="请输入图片描述"></p>
<a id="more"></a>
<h2 id="利用场景"><a href="#利用场景" class="headerlink" title="利用场景"></a>利用场景</h2><p>必须CGI(client)模式，必须变量被脚本调用，服务器开放外网<br>这里的利用场景有点局限，并且还要看CGI是怎么写的，控制HTTP_变量进行操作，脑洞大开吧。<br>首先应该是加一个HTTP_PROXY的选项，让流量到代理服务器中转。其次可以修改HTTP HOST选项，将url请求跳转到第三方服务器。 然后的然后。。。</p>
<h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><p>修复就主要参考：<a href="https://httpoxy.org/#fix-now" target="_blank" rel="external">https://httpoxy.org/#fix-now</a></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://httpoxy.org/" target="_blank" rel="external">https://httpoxy.org/</a><br><a href="https://www.symfony.fi/entry/httpoxy-vulnerability-hits-php-installations-using-fastcgi-and-php-fpm-and-hhvm" target="_blank" rel="external">https://www.symfony.fi/entry/httpoxy-vulnerability-hits-php-installations-using-fastcgi-and-php-fpm-and-hhvm</a><br><a href="https://access.redhat.com/security/vulnerabilities/httpoxy" target="_blank" rel="external">https://access.redhat.com/security/vulnerabilities/httpoxy</a><br><a href="http://bobao.360.cn/learning/detail/2903.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/2903.html</a><br><a href="http://www.laruence.com/2016/07/19/3101.html" target="_blank" rel="external">http://www.laruence.com/2016/07/19/3101.html</a> </p>
</div></article><div class="tags"><a href="/tags/httpoxy/">httpoxy</a></div><div class="paginator"><a href="/2016/10/23/CVE-2016-5195 Dirty Cow/" class="prev"><i class="iconfont icon-left"></i><span> 上一页</span></a><a href="/2016/07/16/ubuntu搭建vnc服务/" class="next"><span>下一页</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div data-thread-key="http://duolaa.xyz/2016/07/19/httpoxy/index.html" data-title="Httpoxy漏洞预警" data-url="http://duolaa.xyz/2016/07/19/httpoxy/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "duolaa" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section></section><footer><div class="copyright"><p>&copy;2015-2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Dunn</span><span class="heart"><i class="iconfont icon-heart"></i> Theme by </span><a href="https://github.com/ahonn/hexo-theme-even">   Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/back2top.js"></script></html>