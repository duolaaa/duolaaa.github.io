<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description"><meta name="viewport" content="width=device-width, initial-scale=1"><title>echarts+php+mysql · Duolaa</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">Duolaa</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">echarts+php+mysql</h1><span class="post-time">Dec 16, 2015</span><div class="post-content"><p>echarts是百度出品的前端图表可视化产品，就在本博文前几天，ECharts 3 测试版发布，焕然一新的面貌。。。。。。。。。。</p>
<h2 id="echarts简介"><a href="#echarts简介" class="headerlink" title="echarts简介"></a>echarts简介</h2><p>ECharts：百度出品的一款图形化数据展示的前端代码，是一款开源、功能强大的数据可视化产品，紧跟着大数据时代的步伐，提供商业产品常用图表，底层基于ZRender（一个全新的轻量级canvas类库），创建了坐标系，图例，提示，工具箱等基础组件，并在此上构建出折线图、柱状图、散点图、K线图、饼图、雷达图、地图、和弦图、力导向布局图、仪表盘以及漏斗图，同时支持任意维度的堆积和多图表混合展现。<br>官网地址：<br>    <a href="http://echarts.baidu.com/index.html" target="_blank" rel="external">http://echarts.baidu.com/index.html</a></p>
<p>通过阅读官方文档，在首页实例部分有很多相关图标的例子，真是做前端的利器，目前很多企业都在做威胁感知、威胁态势分析等系统，前端都是用echarts进行展示，其中地图是用的比较多的，如下图所示。最近想展示一些数据，因此对echarts研究了一下，发现官方的实例文档没有动态获取数据的例子，因此有了本篇文章。<br><img src="http://i.imgur.com/sJqC6op.png" alt=""></p>
<a id="more"></a>
<h2 id="入门创建图表"><a href="#入门创建图表" class="headerlink" title="入门创建图表"></a>入门创建图表</h2><p>官方文档中，有5分钟上手写ECharts的第一个图表，采用模块化单文件引入方式进行编写，详看<br> <code>http://echarts.baidu.com/doc/start.html</code><br>就这样，我们就创建了一个简易的图表。其他的类似，还请详细阅读官方文档，</p>
<h2 id="动态获取数据"><a href="#动态获取数据" class="headerlink" title="动态获取数据"></a>动态获取数据</h2><p>上述的创建图表只是填写的静态数据，动态数据如下：<br>这里以饼图为例子：首先创建mysql数据库查询语句，这里的查询语句简写的， $mydb是new的一个数据库操作类对象，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function selectServiceANDSumm($sql)&#123;</div><div class="line">	global $mydb; //$mydb new db_mysql()类</div><div class="line">	$result = $mydb-&gt;query($sql);</div><div class="line">	$newarray = array();</div><div class="line">	while($row = mysql_fetch_array($result))&#123;</div><div class="line">		$newarray[]=array(&apos;name&apos; =&gt;$row[&apos;service&apos;] ,&apos;value&apos; =&gt;$row[&apos;summ&apos;] );</div><div class="line">	&#125;</div><div class="line">	return json_encode($newarray); //转换成json进行返回</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里将数据的拼接成数组，然后返回json格式。然后前端采用ajax的方式获取刚才查询出来的数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()&#123;</div><div class="line">     $.ajax(&#123;</div><div class="line">            type: &quot;POST&quot;,</div><div class="line">            url: &quot;getData.php&quot;,</div><div class="line">            data: &quot;name=OsANDvalue&quot;,</div><div class="line">            dataType: &quot;json&quot;,</div><div class="line">            async: false,  //这个同步请求，异步不成功。</div><div class="line">            success: function(data)&#123;&#125;  //成功就处理数据</div><div class="line">			error: function(jqXHR)&#123;    //失败就弹出错误代码</div><div class="line">            	alert(&quot;error status:&quot; + jqXHR.status);</div><div class="line">           &#125;</div></pre></td></tr></table></figure></p>
<p>getData.php请求的数据，采用下面的方式进行返回给ajax：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$whatData = $_POST[&apos;name&apos;];</div><div class="line">switch ($whatData) &#123;</div><div class="line">	case &apos;ServiceANDSumm&apos;:</div><div class="line">		echo selectServiceANDSumm($sql);</div><div class="line">	default:</div><div class="line">		</div><div class="line">		break;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样前端就获取到了json格式的数据，用于前端展示了。</p>
<h2 id="series数据的循环获取"><a href="#series数据的循环获取" class="headerlink" title="series数据的循环获取"></a>series数据的循环获取</h2><p>echarts最重要的就是series里面的数据，采用一下方式进行展示，类似的legend里面data字段展示也用下面的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">series : [&#123;</div><div class="line">    name:&apos;system&apos;,</div><div class="line">    type:&apos;pie&apos;,</div><div class="line">    radius : [50,170],</div><div class="line">    center: [&apos;50%&apos;, &apos;50%&apos;],					//其中字段的含义请阅读官方文档，都有说明</div><div class="line">    roseType: &apos;area&apos;,</div><div class="line">    x: &apos;40%&apos;,</div><div class="line">    max: 40,</div><div class="line">    sort: &apos;ascending&apos;,</div><div class="line">    data: function()&#123;</div><div class="line">    	var arr = [];</div><div class="line">    	for (var i = data.length - 1; i &gt;= 0; i--) &#123;</div><div class="line">    		arr.push(&#123;</div><div class="line">    			name:data[i].name,</div><div class="line">    			value:data[i].value</div><div class="line">    		&#125;);</div><div class="line">    	&#125;;</div><div class="line">    	return arr;</div><div class="line">    &#125;() 	//这里必须要加()。</div><div class="line">&#125;]</div></pre></td></tr></table></figure>
<p>至此，一个标准的动态获取数据进行展示的例子已经完成，效果<br><img src="http://i.imgur.com/17LcfM0.png" alt=""></p>
<p>至此，整个动态回去数据进行展示已经结束，其他的效果图展示类似，还是多看官方文档吧。<br>下面贴一些我的html吧，需要源码的朋友也可以私信我。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;;&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;duolaa&lt;/title&gt;</div><div class="line">    &lt;script src=&quot;js/esl.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;js/echarts.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;js/jquery/jquery.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;div id=&quot;head&quot; style=&quot;heghit:15%;&quot;&gt;</div><div class="line">	&lt;h3&gt;head&lt;/h3&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;!-- 为ECharts准备一个具备大小（宽高）的Dom --&gt;</div><div class="line">    </div><div class="line">    &lt;div id=&quot;pie&quot; style=&quot;width:100%;height:650px;background-color:pink;&quot;&gt;&lt;/div&gt;</div><div class="line">     &lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">        // 路径配置</div><div class="line">        require.config(&#123;</div><div class="line">            paths:&#123; </div><div class="line">                &apos;echarts&apos; : &apos;js/echarts&apos;,</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        </div><div class="line">        // 使用</div><div class="line">        require(</div><div class="line">            [</div><div class="line">                &apos;echarts&apos;,</div><div class="line">                &apos;echarts/chart/pie&apos;</div><div class="line">            ],</div><div class="line">            function (ec) &#123;</div><div class="line">                // 基于准备好的dom，初始化echarts图表</div><div class="line">                var myChartpie = ec.init(document.getElementById(&apos;pie&apos;), &apos;macarons&apos;);</div><div class="line">                //myChart.setTheme(&quot;macarons&quot;);</div><div class="line">                $(document).ready(function()&#123;</div><div class="line">                    $.ajax(&#123;</div><div class="line">                        type: &quot;POST&quot;,</div><div class="line">                        url: &quot;getData.php&quot;,</div><div class="line">                        data: &quot;name=OsANDvalue&quot;,</div><div class="line">                        dataType: &quot;json&quot;,</div><div class="line">                        async: false,</div><div class="line">                        success: function(data)&#123;</div><div class="line">                            myChartpie.setOption(&#123;</div><div class="line">                                title : &#123;</div><div class="line">                                    text: &apos;操作系统饼图分布&apos;,</div><div class="line">                                    subtext: &apos;os分类统计&apos;,</div><div class="line">                                    x:&apos;center&apos;,</div><div class="line">                                    y:&apos;top&apos;</div><div class="line">                                &#125;,</div><div class="line">                                tooltip : &#123;</div><div class="line">                                    trigger: &apos;item&apos;,</div><div class="line">                                    formatter: &quot;&#123;a&#125; &lt;br/&gt;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&quot;</div><div class="line">                                &#125;,</div><div class="line">                                calculable : true,</div><div class="line">                                series : [&#123;</div><div class="line">                                    name:&apos;system&apos;,</div><div class="line">                                    type:&apos;pie&apos;,</div><div class="line">                                    radius : [50,170],</div><div class="line">                                    center: [&apos;50%&apos;, &apos;50%&apos;],</div><div class="line">                                    roseType: &apos;area&apos;,</div><div class="line">                                    x: &apos;40%&apos;,</div><div class="line">                                    max: 40,</div><div class="line">                                    sort: &apos;ascending&apos;,</div><div class="line">                                    data: function()&#123;</div><div class="line">                                    	var arr = [];</div><div class="line">                                    	for (var i = data.length - 1; i &gt;= 0; i--) &#123;</div><div class="line">                                    		arr.push(&#123;</div><div class="line">                                    			name:data[i].name,</div><div class="line">                                    			value:data[i].value</div><div class="line">                                    		&#125;);</div><div class="line">                                    	&#125;;</div><div class="line">                                    	return arr;</div><div class="line">                                    &#125;()</div><div class="line">                                &#125;]</div><div class="line">                            &#125;);</div><div class="line">                        &#125;,</div><div class="line">                        error: function(jqXHR)&#123;</div><div class="line">                            alert(&quot;error status:&quot; + jqXHR.status);</div><div class="line">                        &#125;</div><div class="line">                    &#125;);</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        );</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;div id=&quot;footer&quot; style=&quot;heghit:15%;&quot;&gt;</div><div class="line">	&lt;h3&gt;footer&lt;/h3&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
</div></article><div class="tags"><a href="/tags/echarts/">echarts</a></div><div class="paginator"><a href="/2016/07/16/hello-world/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a><a href="/2015/12/06/ssh远程登录/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div data-thread-key="http://duolaa.xyz/2015/12/16/echarts+php+mysql/index.html" data-title="echarts+php+mysql" data-url="http://duolaa.xyz/2015/12/16/echarts+php+mysql/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "duolaa" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section></section><footer><div class="copyright"><p>&copy;2015-2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Dunn</span><span class="heart"><i class="iconfont icon-heart"></i> Theme by </span><a href="https://github.com/ahonn/hexo-theme-even">   Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/back2top.js"></script></html>